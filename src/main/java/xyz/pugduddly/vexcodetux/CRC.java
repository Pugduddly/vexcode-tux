package xyz.pugduddly.vexcodetux;

public class CRC {
    public static CRC VEX_CRC16 = new CRC(16, new long[] {
        0, 69665, 139330, 208995, 278660, 348325, 417990, 487655, 557320, 626985, 696650, 766315, 835980, 905645, 975310, 1044975,
        1118769, 1049104, 1258099, 1188434, 1397429, 1327764, 1536759, 1467094, 1676089, 1606424, 1815419, 1745754, 1954749, 1885084, 2094079, 2024414,
        2237538, 2307139, 2098208, 2167809, 2516198, 2585799, 2376868, 2446469, 2794858, 2864459, 2655528, 2725129, 3073518, 3143119, 2934188, 3003789,
        3356243, 3286642, 3216913, 3147312, 3634903, 3565302, 3495573, 3425972, 3913563, 3843962, 3774233, 3704632, 4192223, 4122622, 4052893, 3983292,
        4475076, 4544741, 4614278, 4683943, 4196416, 4266081, 4335618, 4405283, 5032396, 5102061, 5171598, 5241263, 4753736, 4823401, 4892938, 4962603,
        5593845, 5524180, 5733047, 5663382, 5315185, 5245520, 5454387, 5384722, 6151165, 6081500, 6290367, 6220702, 5872505, 5802840, 6011707, 5942042,
        6712486, 6782087, 6573284, 6642885, 6433826, 6503427, 6294624, 6364225, 7269806, 7339407, 7130604, 7200205, 6991146, 7060747, 6851944, 6921545,
        7831191, 7761590, 7691989, 7622388, 7552531, 7482930, 7413329, 7343728, 8388511, 8318910, 8249309, 8179708, 8109851, 8040250, 7970649, 7901048,
        8950152, 9011625, 9089482, 9150955, 9228556, 9290029, 9367886, 9429359, 8392832, 8454305, 8532162, 8593635, 8671236, 8732709, 8810566, 8872039,
        10060729, 9999256, 10200059, 10138586, 10339133, 10277660, 10478463, 10416990, 9503409, 9441936, 9642739, 9581266, 9781813, 9720340, 9921143, 9859670,
        11187690, 11249099, 11048360, 11109769, 11466094, 11527503, 11326764, 11388173, 10630370, 10691779, 10491040, 10552449, 10908774, 10970183, 10769444, 10830853,
        12298203, 12236794, 12158873, 12097464, 12576607, 12515198, 12437277, 12375868, 11740883, 11679474, 11601553, 11540144, 12019287, 11957878, 11879957, 11818548,
        13424972, 13486445, 13564174, 13625647, 13146568, 13208041, 13285770, 13347243, 12867652, 12929125, 13006854, 13068327, 12589248, 12650721, 12728450, 12789923,
        14535549, 14474076, 14674751, 14613278, 14257145, 14195672, 14396347, 14334874, 13978229, 13916756, 14117431, 14055958, 13699825, 13638352, 13839027, 13777554,
        15662382, 15723791, 15523180, 15584589, 15383978, 15445387, 15244776, 15306185, 15105062, 15166471, 14965860, 15027269, 14826658, 14888067, 14687456, 14748865,
        16772895, 16711486, 16633693, 16572284, 16494491, 16433082, 16355289, 16293880, 16215575, 16154166, 16076373, 16014964, 15937171, 15875762, 15797969, 15736560
    });
    public static CRC VEX_CRC32 = new CRC(32, new long[] {
        0L, 4374732215L, 8749464430L, 13107406553L, 17498928860L, 21873650539L, 26214813106L, 30572761093L,
        34997857720L, 39238365199L, 43747301078L, 47971027809L, 52429626212L, 56670127827L, 61145522186L,
        65369259453L, 69995715440L, 74236085959L, 78476730398L, 82700336553L, 87494602156L, 91734978587L,
        95942055618L, 100165651317L, 104859252424L, 109233843071L, 113340255654L, 117698072593L, 122291044372L, 126665645475L,
        130738518906L, 135096329933L, 139991430880L, 144366021463L, 148472171918L, 152829988921L, 156953460796L, 161328061835L,
        165400673106L, 169758484197L, 174989204312L, 179229574895L, 183469957174L, 187693563265L, 191884111236L, 196124487731L,
        200331302634L, 204554898269L, 209718504848L, 213959012391L, 218467686142L, 222691412809L, 226680511308L, 230921012987L,
        235396145186L, 239619882389L, 244582088744L, 248956820895L, 253331290950L, 257689233137L, 261477037812L, 265851759427L,
        270192659866L, 274550607917L, 280054100087L, 275687894464L, 288786500377L, 284437075630L, 297015576235L, 292649376540L,
        305714445765L, 301365010546L, 313843949007L, 309611954296L, 322576361121L, 318361156374L, 330738363155L, 326506378916L,
        339437211773L, 335222001098L, 349915556615L, 345683441328L, 358379524201L, 354164182494L, 366877072859L, 362644947052L,
        375307495093L, 371092159234L, 383839585983L, 379473255176L, 392303574481L, 387954008166L, 400733974627L, 396367637972L,
        409164385037L, 404814829242L, 419508373143L, 415142042400L, 427972623865L, 423623057486L, 437006741579L, 432640404988L,
        445437414181L, 441087858322L, 453298170671L, 449066055320L, 461762400321L, 457547058678L, 470729448947L, 466497323076L,
        479160133277L, 474944797482L, 489101204967L, 484869210192L, 497833879177L, 493618674494L, 506599598907L, 502367614604L,
        515298709589L, 511083498978L, 523025313887L, 518659108328L, 531757976369L, 527408551558L, 540456552067L, 536090352436L,
        549155683821L, 544806248538L, 560108200174L, 564482932057L, 551375788928L, 555733730871L, 577573000754L, 581947722629L,
        568874151260L, 573232099563L, 594031152470L, 598271660257L, 585298753080L, 589522480015L, 611428891530L, 615669392957L,
        602730021092L, 606953758035L, 627687898014L, 631928268329L, 619223908592L, 623447514439L, 645152722242L, 649393098997L,
        636722312748L, 640945908635L, 661476726310L, 665851317137L, 653012757832L, 657370575103L, 678874423546L, 683249024333L,
        670444002196L, 674801813027L, 699831113230L, 704205704121L, 691366882656L, 695724699863L, 716759048402L, 721133649253L,
        708328364988L, 712686175755L, 733754145718L, 737994515969L, 725289894104L, 729513500015L, 750614990186L, 754855366877L,
        742184318468L, 746407914419L, 767679171966L, 771919679689L, 758946510352L, 763170237351L, 784607148962L, 788847650325L,
        775908016332L, 780131753339L, 801467949254L, 805842681201L, 792735275944L, 797093217823L, 818328770074L, 822703492013L,
        809629658484L, 813987606723L, 839087984793L, 834721778990L, 830338542583L, 825989117504L, 856016479813L, 851650280434L,
        847300582699L, 842951147676L, 873950510369L, 869718515862L, 865201047119L, 860985842680L, 890811845629L, 886579861066L,
        882095960211L, 877880749348L, 906533489641L, 902301374046L, 898052485255L, 893837143344L, 923461958965L, 919229833346L,
        915014485595L, 910799150060L, 941530261073L, 937163930598L, 933049244991L, 928699678856L, 958391636109L, 954025299258L,
        949944183779L, 945594627668L, 978273773177L, 973907442638L, 969793019159L, 965443453088L, 995739127973L, 991372791058L,
        987291937739L, 982942381692L, 1013136346049L, 1008904230518L, 1004655603887L, 1000440261912L, 1030534577437L, 1026302451882L,
        1022087366259L, 1017872030660L, 1045987654921L, 1041755660478L, 1037238453863L, 1033023249360L, 1063452969941L, 1059220985442L,
        1054737346747L, 1050522135820L, 1080984342705L, 1076618136838L, 1072235162591L, 1067885737576L, 1098382599789L, 1094016400346L,
        1089666964739L, 1085317529780L});

    private int size;
    public long[] table;

    public CRC(int size, long[] table) {
        this.size = size;
        this.table = table;
    }

    public long compute(byte[] data) {
        return this.compute(data, 0);
    }

    public long compute(byte[] data, long accumulator) {
        for (int i = 0; i < data.length; i ++) {
            int j = (int) (((accumulator >> (this.size - 8L)) ^ (long) data[i]) & 0xff);
            accumulator = ((accumulator << 8L) ^ (long) this.table[(int) j]) & ((1L << this.size) - 1);
        }
        return accumulator;
    }
}